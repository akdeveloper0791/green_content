{% load static %}
<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
{% block header %} {% include 'header.html' %} {% endblock %}
{% block body %}


<body onload="afterLoad()">

<script  src="{% static 'scripts/Dropbox-sdk.min.js' %}"></script>

<script  src="{% static 'upload_file_anim/upload_file_anim.js' %}"></script>

<link rel="stylesheet" href="{% static 'upload_file_anim/upload_file_anim.css' %}">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
 <style>
.h4,h4{
    margin:0px;
}

.actives{
    background:green;

}
a.btn:active{
    background:green;
}
</style>
<br/><br/>

<section id="contact" class="section-padding">
  
<div class='container' id="listemail">
<div class='rows'>
  <a class="nav-link" href="{% url 'create' %}" style="float:right;font-weight:bold" >
    <button class="btn btn-success"><i class='fa fa-plus'> Create Campaign</i></button></a><br/><br/>
<div class='panel panel-default'>
	<div class='panel-heading' style='background: cornflowerblue;color: white;'>Campaign List</div>

<!-- 	<ul class='list-group'> -->
  {% load tz %}
  {% timezone "Australia/Lord_Howe" %}<!-- temp solution convert to indian format-->
	
	{% for campaign in res.campaigns %}
   <div class="col-md-12 col-xs-12" style="padding:0px;border-bottom: 1px solid darkgrey;">
    <div class="rows" id="campaign_row_{{ campaign.id }}">
       <div class="col-md-2 col-xs-2" style="padding:0px;">
        <img id="thumb_img_{{ campaign.id }}" src="{% static 'images/campaign/default_campaign.png' %}" style="
          border-radius: 4px;
          padding: 2px 0px;
          /* margin: 0px; */
          width: 75%;
          height: 90px;
          display: block;
          margin-left: auto;
          margin-right: auto;
        ">
      </div>
      <div class="col-md-8 col-xs-8" style="padding: 20px 2px;">
        <p class="btn-custom" style="color:dodgerblue;margin: 0px;font-weight: 700;">{{ campaign.campaign_name }}</p>
        
        
        <p style="color:gray;font-size: 12px;">{{ campaign.updated_date|localtime }}</p>
       
      </div>
   <!--    <div class="col-md-1 col-xs-1" style="padding:0px;text-align: center;">
          <i class='fa fa-file-archive-o fa-lg' style='color:deepskyblue;margin:5px;cursor: pointer;padding: 30px 0px;' alt="Archive" title="Archive" onclick='function display(){swal("comming soon")};display()'></i>
      </div> 
        <div class="col-md-1 col-xs-1" style="padding:0px;text-align: center;">
          
      </div>-->
      <div class="col-md-2 col-xs-2" style="padding:0px;text-align: center;">
        <i class='fa fa-trash fa-lg' style='color:orangered;margin:5px;cursor: pointer;padding: 30px 0px;' alt="Delete" title="Delete" onclick='deleteCampaign("{{campaign.id}}")'></i>

        <a href="/campaigns/previewCampaign/{{campaign.id}}" target='_blank'>
          <i class='fa fa-eye fa-lg' style='color:yellowgreen;margin:5px;cursor:pointer;padding: 30px 0px;' alt="Preview" title="Preview"></i>
        </a>

        <i class='fa fa-television fa-lg' style='color:yellowgreen;margin:5px;cursor: pointer;padding: 30px 0px;' alt="Delete" title="Publish" onclick='publishCampaign("{{campaign.id}}")'></i>

      </div>


    </div>
  </div>
	{% endfor %}

  {% endtimezone %}

<!-- 
	</ul> -->
 
</div> 
</div> 
</div>
</section>
<div class="container">
  <div class="modal centered-modal" tabindex="-1" role="dialog" id="busy_dialog">

  <div class="modal-dialog" role="document">
  
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header" id="busy_dialog_header" style="display:none"> 
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" display = "none"></h4>
        </div>
        <div class="modal-body">
          <!--initiate busy spinner -->
           <div id="init_upload_busy_dialg_div" align="center" style="display:none">
            <div class="loader" > </div>
            <p id="busy_dialog_msg">Deleting...</p>
            </div>
          

          <!-- file upload progress -->
          <div style="clear: both;display:none" id="uploading_file_info_div">
              <h4 style="float: left" id="uploading_file_name_elm"></h2>
              <h6 style="float: right" id="uploading_file_count_elm"></h3>
          </div>

          <!-- init file upload progress bar -->
          <div id="init_file_upload_busy_dialg_div"class="progress" style="display:none">
          <div class="indeterminate"></div>
          </div>
          
          <div class="progress" id="file_upload_progress_dialg_parent_div" style="display:none">

          <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%;" id="file_upload_progress_dialg_div">0 
      
          </div>

          <p>.</p>
        </div>
        </div>
        
      </div>
      
    </div>
  </div>
  
</div>

{% include 'campaign/list_players_to_publish.html' %}

<script>
var csrf_token = '{{ csrf_token }}';
var downloadThumbPosition=0;
var downloadThumbInfo = {
    id: 0,
    save_path: null,
    resourceName: null,//resource name
  
  };

 (function() {
     // your page initialization code here
     // the DOM will be available here
   var ga = document.createElement("script"); //ga is to remember Google Analytics ;-)
   ga.type = 'text/javascript';
   ga.src = "{% static 'js/campaign/list.js' %}";

   ga.id = 'invisible';
   document.body.appendChild(ga);
   

  })();

$(".btn-custom").text(function(index, currentText) {
  if(currentText.length>15){
    return currentText.substr(0, 15)+'...';
  }
});

function getDownloadThumbInfo()
{
  var iteratePos = 0;
  {% for campaign in res.campaigns %}
      if(downloadThumbPosition==iteratePos)
      {
        downloadThumbInfo.id = {{campaign.id}};
        downloadThumbInfo.save_path= "{{campaign.save_path}}";
        downloadThumbInfo.resourceName= "{{campaign.campaign_name}}";
        
        //increate position to get next thumb
        ++downloadThumbPosition;
        return true;
      }else
      {
        ++iteratePos;
      }
  {% endfor %}
   
   return false;
}

function afterLoad()
{  
   checkAndDownloadThumbFile(); 
}
</script>
{% endblock %}


{% block footer %} {% include 'footer.html' %} {% endblock %}
  <script type="text/javascript">
$(document).ready(function(){
$('#management').addClass('active');
    });
  </script>
</body>

</html>
